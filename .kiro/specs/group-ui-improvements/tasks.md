# 実装計画

- [x] 1. バックエンド Group テーブル order カラム拡張

  - [x] 1.1 データベースマイグレーションの作成

    - Group テーブルに order カラム（int 型、非 UNIQUE）を追加
    - 既存レコードの order を 1 に設定するマイグレーション
    - インデックス追加（パフォーマンス向上）
    - _要件: 2.1, 2.3_

  - [x] 1.2 Group Repository の order 対応実装

    - GroupRepositoryImpl で findAll 時に order 昇順ソートを追加
    - save 時に新規 Group の order を 99999 に設定
    - order フィールドをインフラ層に隠蔽（ドメイン層には露出しない）
    - _要件: 2.2, 2.4, 2.5_

  - [x] 1.3 Group order 機能のユニットテスト
    - Repository の order ソート機能テスト
    - 新規 Group 作成時の order 設定テスト
    - マイグレーション後のデータ整合性テスト
    - _要件: 2.2, 2.4_

- [ ] 2. フロントエンド ナビゲーションリンク追加

  - [ ] 2.1 PC サイドバーへの Groups Add リンク追加

    - `web/components/aside/Aside.tsx` に `/groups/add` リンクを追加
    - 適切なアイコンとラベルの設定（i18n 対応）
    - 既存ナビゲーション構造の維持
    - _要件: 1.1, 1.4, 1.5_

  - [ ] 2.2 モバイルサイドバーへの Groups Add リンク追加

    - `web/components/header/xs/HeaderXSSheet.tsx` に `/groups/add` リンクを追加
    - PC 版と同様のアイコンとラベル設定
    - モバイル UI での適切な表示確認
    - _要件: 1.2, 1.4, 1.5_

  - [ ] 2.3 ナビゲーションリンクのユニットテスト
    - PC/モバイル両方でのリンク存在確認テスト
    - リンククリック時の遷移動作テスト
    - 既存ナビゲーション機能の回帰テスト
    - _要件: 1.1, 1.2, 1.3, 1.5_

- [ ] 3. Next.js 認証エラー修正

  - [ ] 3.1 Header.tsx の認証エラー調査と修正

    - 現在の `auth()` 呼び出し箇所の特定
    - 「Auth called outside request scope」エラーの原因分析
    - 適切なリクエストスコープ内での `auth()` 実行への修正
    - _要件: 3.1, 3.4_

  - [ ] 3.2 Next.js 16 アップグレードの検討と実行

    - 現在の Next.js バージョン確認
    - Next.js 16 へのアップグレード実行
    - レイアウトの dynamic 化による認証エラー解決確認
    - _要件: 3.2, 3.3_

  - [ ] 3.3 認証エラー修正のユニットテスト
    - Header コンポーネントの認証エラー解消確認テスト
    - 既存 Header 機能の正常動作テスト
    - ブラウザコンソールエラーの非表示確認テスト
    - _要件: 3.1, 3.4, 3.5_

- [ ] 4. 統合テストと動作確認

  - [ ] 4.1 ナビゲーション機能の統合テスト

    - PC/モバイル両方での `/groups/add` リンク動作確認
    - 既存ナビゲーション機能の回帰テスト
    - レスポンシブ対応の確認
    - _要件: 1.1, 1.2, 1.3, 1.5_

  - [ ] 4.2 Group order 機能の統合テスト

    - データベースマイグレーション後の動作確認
    - Group 一覧取得時のソート順確認
    - 新規 Group 作成時の order 設定確認
    - _要件: 2.2, 2.3, 2.4_

  - [ ] 4.3 認証エラー修正の統合テスト
    - Next.js 16 アップグレード後の全体動作確認
    - Header コンポーネントのエラー解消確認
    - 既存認証フローの正常動作確認
    - _要件: 3.3, 3.4, 3.5_

- [ ] 5. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、質問があればユーザーに尋ねる
